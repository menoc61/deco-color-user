{"ast":null,"code":"import _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport { DataStore } from \"aws-amplify\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport MapView, { Marker } from \"react-native-maps\";\nimport { useState, useEffect } from \"react\";\nimport { Courier, Order } from \"../../models\";\nimport { FontAwesome5 } from \"@expo/vector-icons\";\nimport { useRef } from \"react\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nvar OrderLiveUpdates = function OrderLiveUpdates(_ref) {\n  var id = _ref.id;\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      order = _useState2[0],\n      setOrder = _useState2[1];\n\n  var _useState3 = useState(null),\n      _useState4 = _slicedToArray(_useState3, 2),\n      courier = _useState4[0],\n      setCourier = _useState4[1];\n\n  var mapRef = useRef(null);\n  useEffect(function () {\n    DataStore.query(Order, id).then(setOrder);\n  }, []);\n  useEffect(function () {\n    if (!order) {\n      return;\n    }\n\n    var subscription = DataStore.observe(Order, order.id).subscribe(function (msg) {\n      if (msg.opType === \"UPDATE\") {\n        setOrder(msg.element);\n      }\n    });\n    return function () {\n      return subscription.unsubscribe();\n    };\n  }, [order]);\n  useEffect(function () {\n    if (order != null && order.orderCourierId) {\n      DataStore.query(Courier, order.orderCourierId).then(setCourier);\n    }\n  }, [order == null ? void 0 : order.orderCourierId]);\n  useEffect(function () {\n    if (courier != null && courier.lng && courier != null && courier.lat) {\n      mapRef.current.animateToRegion({\n        latitude: courier.lat,\n        longitude: courier.lng,\n        latitudeDelta: 0.007,\n        longitudeDelta: 0.007\n      });\n    }\n  }, [courier == null ? void 0 : courier.lng, courier == null ? void 0 : courier.lat]);\n  useEffect(function () {\n    if (!courier) {\n      return;\n    }\n\n    var subscription = DataStore.observe(Courier, courier.id).subscribe(function (msg) {\n      if (msg.opType === \"UPDATE\") {\n        setCourier(msg.element);\n      }\n    });\n    return function () {\n      return subscription.unsubscribe();\n    };\n  }, [courier]);\n  return _jsxs(View, {\n    children: [_jsxs(Text, {\n      children: [\"Status: \", (order == null ? void 0 : order.status) || \"loading\"]\n    }), _jsx(MapView, {\n      style: styles.map,\n      ref: mapRef,\n      showsUserLocation: true,\n      children: (courier == null ? void 0 : courier.lat) && _jsx(Marker, {\n        coordinate: {\n          latitude: courier.lat,\n          longitude: courier.lng\n        },\n        children: _jsx(View, {\n          style: {\n            padding: 5,\n            backgroundColor: \"green\",\n            borderRadius: 40\n          },\n          children: _jsx(FontAwesome5, {\n            name: \"motorcycle\",\n            size: 24,\n            color: \"white\"\n          })\n        })\n      })\n    })]\n  });\n};\n\nvar styles = StyleSheet.create({\n  map: {\n    width: \"100%\",\n    height: \"100%\"\n  }\n});\nexport default OrderLiveUpdates;","map":{"version":3,"names":["DataStore","MapView","Marker","useState","useEffect","Courier","Order","FontAwesome5","useRef","OrderLiveUpdates","id","order","setOrder","courier","setCourier","mapRef","query","then","subscription","observe","subscribe","msg","opType","element","unsubscribe","orderCourierId","lng","lat","current","animateToRegion","latitude","longitude","latitudeDelta","longitudeDelta","status","styles","map","padding","backgroundColor","borderRadius","StyleSheet","create","width","height"],"sources":["C:/Users/MENO/Desktop/PROJECT/APP-DECO-COLOR/deco-color-user/src/screens/OrderLiveUpdates/index.js"],"sourcesContent":["import { DataStore } from \"aws-amplify\";\nimport { View, Text, StyleSheet } from \"react-native\";\nimport MapView, { Marker } from \"react-native-maps\";\nimport { useState, useEffect } from \"react\";\nimport { Courier, Order } from \"../../models\";\nimport { FontAwesome5 } from \"@expo/vector-icons\";\nimport { useRef } from \"react\";\n\nconst OrderLiveUpdates = ({ id }) => {\n  const [order, setOrder] = useState(null);\n  const [courier, setCourier] = useState(null);\n\n  const mapRef = useRef(null);\n\n  useEffect(() => {\n    DataStore.query(Order, id).then(setOrder);\n  }, []);\n\n  useEffect(() => {\n    if (!order) {\n      return;\n    }\n    const subscription = DataStore.observe(Order, order.id).subscribe((msg) => {\n      if (msg.opType === \"UPDATE\") {\n        setOrder(msg.element);\n      }\n    });\n\n    return () => subscription.unsubscribe();\n  }, [order]);\n\n  useEffect(() => {\n    if (order?.orderCourierId) {\n      DataStore.query(Courier, order.orderCourierId).then(setCourier);\n    }\n  }, [order?.orderCourierId]);\n\n  useEffect(() => {\n    if (courier?.lng && courier?.lat) {\n      mapRef.current.animateToRegion({\n        latitude: courier.lat,\n        longitude: courier.lng,\n        latitudeDelta: 0.007,\n        longitudeDelta: 0.007,\n      });\n    }\n  }, [courier?.lng, courier?.lat]);\n\n  useEffect(() => {\n    if (!courier) {\n      return;\n    }\n    const subscription = DataStore.observe(Courier, courier.id).subscribe(\n      (msg) => {\n        if (msg.opType === \"UPDATE\") {\n          setCourier(msg.element);\n        }\n      }\n    );\n    return () => subscription.unsubscribe();\n  }, [courier]);\n\n  return (\n    <View>\n      <Text>Status: {order?.status || \"loading\"}</Text>\n      <MapView style={styles.map} ref={mapRef} showsUserLocation>\n        {courier?.lat && (\n          <Marker\n            coordinate={{ latitude: courier.lat, longitude: courier.lng }}\n          >\n            <View\n              style={{\n                padding: 5,\n                backgroundColor: \"green\",\n                borderRadius: 40,\n              }}\n            >\n              <FontAwesome5 name=\"motorcycle\" size={24} color=\"white\" />\n            </View>\n          </Marker>\n        )}\n      </MapView>\n    </View>\n  );\n};\n\nconst styles = StyleSheet.create({\n  map: {\n    width: \"100%\",\n    height: \"100%\",\n  },\n});\n\nexport default OrderLiveUpdates;\n"],"mappings":";AAAA,SAASA,SAAT,QAA0B,aAA1B;;;;AAEA,OAAOC,OAAP,IAAkBC,MAAlB,QAAgC,mBAAhC;AACA,SAASC,QAAT,EAAmBC,SAAnB,QAAoC,OAApC;AACA,SAASC,OAAT,EAAkBC,KAAlB;AACA,SAASC,YAAT,QAA6B,oBAA7B;AACA,SAASC,MAAT,QAAuB,OAAvB;;;;AAEA,IAAMC,gBAAgB,GAAG,SAAnBA,gBAAmB,OAAY;EAAA,IAATC,EAAS,QAATA,EAAS;;EACnC,gBAA0BP,QAAQ,CAAC,IAAD,CAAlC;EAAA;EAAA,IAAOQ,KAAP;EAAA,IAAcC,QAAd;;EACA,iBAA8BT,QAAQ,CAAC,IAAD,CAAtC;EAAA;EAAA,IAAOU,OAAP;EAAA,IAAgBC,UAAhB;;EAEA,IAAMC,MAAM,GAAGP,MAAM,CAAC,IAAD,CAArB;EAEAJ,SAAS,CAAC,YAAM;IACdJ,SAAS,CAACgB,KAAV,CAAgBV,KAAhB,EAAuBI,EAAvB,EAA2BO,IAA3B,CAAgCL,QAAhC;EACD,CAFQ,EAEN,EAFM,CAAT;EAIAR,SAAS,CAAC,YAAM;IACd,IAAI,CAACO,KAAL,EAAY;MACV;IACD;;IACD,IAAMO,YAAY,GAAGlB,SAAS,CAACmB,OAAV,CAAkBb,KAAlB,EAAyBK,KAAK,CAACD,EAA/B,EAAmCU,SAAnC,CAA6C,UAACC,GAAD,EAAS;MACzE,IAAIA,GAAG,CAACC,MAAJ,KAAe,QAAnB,EAA6B;QAC3BV,QAAQ,CAACS,GAAG,CAACE,OAAL,CAAR;MACD;IACF,CAJoB,CAArB;IAMA,OAAO;MAAA,OAAML,YAAY,CAACM,WAAb,EAAN;IAAA,CAAP;EACD,CAXQ,EAWN,CAACb,KAAD,CAXM,CAAT;EAaAP,SAAS,CAAC,YAAM;IACd,IAAIO,KAAJ,YAAIA,KAAK,CAAEc,cAAX,EAA2B;MACzBzB,SAAS,CAACgB,KAAV,CAAgBX,OAAhB,EAAyBM,KAAK,CAACc,cAA/B,EAA+CR,IAA/C,CAAoDH,UAApD;IACD;EACF,CAJQ,EAIN,CAACH,KAAD,oBAACA,KAAK,CAAEc,cAAR,CAJM,CAAT;EAMArB,SAAS,CAAC,YAAM;IACd,IAAIS,OAAO,QAAP,IAAAA,OAAO,CAAEa,GAAT,IAAgBb,OAAhB,YAAgBA,OAAO,CAAEc,GAA7B,EAAkC;MAChCZ,MAAM,CAACa,OAAP,CAAeC,eAAf,CAA+B;QAC7BC,QAAQ,EAAEjB,OAAO,CAACc,GADW;QAE7BI,SAAS,EAAElB,OAAO,CAACa,GAFU;QAG7BM,aAAa,EAAE,KAHc;QAI7BC,cAAc,EAAE;MAJa,CAA/B;IAMD;EACF,CATQ,EASN,CAACpB,OAAD,oBAACA,OAAO,CAAEa,GAAV,EAAeb,OAAf,oBAAeA,OAAO,CAAEc,GAAxB,CATM,CAAT;EAWAvB,SAAS,CAAC,YAAM;IACd,IAAI,CAACS,OAAL,EAAc;MACZ;IACD;;IACD,IAAMK,YAAY,GAAGlB,SAAS,CAACmB,OAAV,CAAkBd,OAAlB,EAA2BQ,OAAO,CAACH,EAAnC,EAAuCU,SAAvC,CACnB,UAACC,GAAD,EAAS;MACP,IAAIA,GAAG,CAACC,MAAJ,KAAe,QAAnB,EAA6B;QAC3BR,UAAU,CAACO,GAAG,CAACE,OAAL,CAAV;MACD;IACF,CALkB,CAArB;IAOA,OAAO;MAAA,OAAML,YAAY,CAACM,WAAb,EAAN;IAAA,CAAP;EACD,CAZQ,EAYN,CAACX,OAAD,CAZM,CAAT;EAcA,OACE,MAAC,IAAD;IAAA,WACE,MAAC,IAAD;MAAA,uBAAe,CAAAF,KAAK,QAAL,YAAAA,KAAK,CAAEuB,MAAP,KAAiB,SAAhC;IAAA,EADF,EAEE,KAAC,OAAD;MAAS,KAAK,EAAEC,MAAM,CAACC,GAAvB;MAA4B,GAAG,EAAErB,MAAjC;MAAyC,iBAAiB,MAA1D;MAAA,UACG,CAAAF,OAAO,QAAP,YAAAA,OAAO,CAAEc,GAAT,KACC,KAAC,MAAD;QACE,UAAU,EAAE;UAAEG,QAAQ,EAAEjB,OAAO,CAACc,GAApB;UAAyBI,SAAS,EAAElB,OAAO,CAACa;QAA5C,CADd;QAAA,UAGE,KAAC,IAAD;UACE,KAAK,EAAE;YACLW,OAAO,EAAE,CADJ;YAELC,eAAe,EAAE,OAFZ;YAGLC,YAAY,EAAE;UAHT,CADT;UAAA,UAOE,KAAC,YAAD;YAAc,IAAI,EAAC,YAAnB;YAAgC,IAAI,EAAE,EAAtC;YAA0C,KAAK,EAAC;UAAhD;QAPF;MAHF;IAFJ,EAFF;EAAA,EADF;AAsBD,CA5ED;;AA8EA,IAAMJ,MAAM,GAAGK,UAAU,CAACC,MAAX,CAAkB;EAC/BL,GAAG,EAAE;IACHM,KAAK,EAAE,MADJ;IAEHC,MAAM,EAAE;EAFL;AAD0B,CAAlB,CAAf;AAOA,eAAelC,gBAAf"},"metadata":{},"sourceType":"module"}